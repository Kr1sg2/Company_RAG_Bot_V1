diff --git a/app.py b/app.py
index 1111111..2222222 100644
--- a/app.py
+++ b/app.py
@@ -15,6 +15,7 @@ from fastapi import FastAPI, Request, HTTPException, Query, Depends
 from fastapi.responses import JSONResponse
 from fastapi.middleware.cors import CORSMiddleware
 from fastapi.security import HTTPBasic
+from starlette.middleware.proxy_headers import ProxyHeadersMiddleware
 from itsdangerous import TimestampSigner, BadSignature, SignatureExpired
 from passlib.context import CryptContext
 from pydantic import BaseModel
@@ -43,7 +44,7 @@ logger = logging.getLogger("lexa-backend")
 # Import enhanced search with error handling
 enhanced_search = None
 try:
-    from app.retrieval import enhanced_search
+    from lexa_app.retrieval import enhanced_search
     logger.info("âœ… Enhanced search imported successfully")
 except Exception as e:
     logger.warning(f"Enhanced search not available: {e}")
@@ -76,12 +77,15 @@ ALLOWED_ORIGINS = [
     "http://localhost:3000",
 ]
 
-app.add_middleware(
-    CORSMiddleware,
-    allow_origins=ALLOWED_ORIGINS,
-    allow_credentials=True,
-    allow_methods=["*"],
-    allow_headers=["*"],
-)
+app.add_middleware(ProxyHeadersMiddleware, trusted_hosts="*")
+app.add_middleware(
+    CORSMiddleware,
+    # Accept any subdomain on bizbots24.com (e.g., lexaai.bizbots24.com, Cloudflare Access, etc.)
+    allow_origin_regex=r"^https://([a-z0-9-]+\.)*bizbots24\.com$",
+    allow_credentials=True,
+    allow_methods=["*"],
+    allow_headers=["*"],
+)
@@ -205,14 +209,14 @@ def admin_login(request: Request, login_data: LoginRequest):
     response = JSONResponse({
         "success": True,
         "message": "Logged in successfully"
     })
 
     # Set session cookie with proper attributes for Cloudflare
-    response.set_cookie(
+    response.set_cookie(
         key="lexa_session",
         value=token,
         max_age=86400,  # 24 hours
         httponly=True,
         secure=True,  # Required for HTTPS
-        samesite="lax",  # Allow cross-site requests from same origin
+        samesite="none",  # Needed for CF Access / third-party contexts
         domain=".bizbots24.com"  # Allow across subdomains
     )
 
     return response
